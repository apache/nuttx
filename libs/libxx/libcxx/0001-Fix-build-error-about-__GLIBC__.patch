--- libcxx/src/locale.cpp
+++ libcxx/src/locale.cpp
@@ -40,6 +40,10 @@

 #include "include/atomic_support.h"
 #include "include/sso_allocator.h"
+#if defined(__NuttX__) && defined(__GLIBC__)
+#  undef __GLIBC__
+#endif
+

 // On Linux, wint_t and wchar_t have different signed-ness, and this causes
 // lots of noise in the build log, but no bugs that I know of.
