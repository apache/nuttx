From e201b5ba1fd11bb486a844afb2362d699f915f7f Mon Sep 17 00:00:00 2001
From: dongjiuzhu1 <dongjiuzhu1@xiaomi.com>
Date: Mon, 27 May 2024 20:32:46 +0800
Subject: [PATCH 10/10] openamp: add assert when get tx buffer failed

So we can found the error more eaily

Signed-off-by: dongjiuzhu1 <dongjiuzhu1@xiaomi.com>
---
 lib/rpmsg/rpmsg_virtio.c | 2 ++
 1 file changed, 2 insertions(+)

diff --git a/lib/rpmsg/rpmsg_virtio.c open-amp/lib/rpmsg/rpmsg_virtio.c
index 4bc6fb21cb..0293d17d24 100644
--- a/lib/rpmsg/rpmsg_virtio.c
+++ open-amp/lib/rpmsg/rpmsg_virtio.c
@@ -391,6 +391,8 @@ static void *rpmsg_virtio_get_tx_payload_buffer(struct rpmsg_device *rdev,
 		}
 	}
 
+	metal_assert(!wait || rp_hdr != NULL);
+
 	if (!rp_hdr)
 		return NULL;
 
-- 
2.34.1

